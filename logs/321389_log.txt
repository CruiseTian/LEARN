Namespace(batch_size=100, bce_lambda=1.0, bec_p=0.0, bec_p_dec=0.0, ber_lambda=1.0, block_len=100, block_len_high=200, block_len_low=10, bsc_p=0.0, bsc_p_dec=0.0, channel='awgn', code_rate_k=1, code_rate_n=3, dec_act='linear', dec_kernel_size=5, dec_lr=0.001, dec_num_layer=5, dec_num_unit=100, dec_rnn='gru', decoder='TurboAE_rate3_cnn2d', demod_lr=0.005, demod_num_layer=1, demod_num_unit=20, dropout=0.0, enc_act='elu', enc_clipping='both', enc_grad_limit=0.01, enc_kernel_size=5, enc_lr=0.001, enc_num_layer=2, enc_num_unit=100, enc_quantize_level=2, enc_rnn='gru', enc_truncate_limit=0, enc_value_limit=1.0, encoder='TurboAE_rate3_cnn2d', extrinsic=1, focal_alpha=1.0, focal_gamma=0.0, img_size=10, init_nw_weight='default', is_interleave=1, is_k_same_code=False, is_parallel=0, is_same_interleaver=1, is_variable_block_len=False, joint_train=0, k_same_code=2, lambda_maxBCE=0.01, loss='bce', mod_lr=0.005, mod_num_layer=1, mod_num_unit=20, mod_pc='block_power', mod_rate=2, momentum=0.9, no_code_norm=False, no_cuda=False, num_ber_puncture=5, num_block=1000, num_epoch=1, num_iter_ft=5, num_iteration=6, num_train_dec=5, num_train_demod=5, num_train_enc=1, num_train_mod=1, optimizer='adam', precompute_norm_stats=False, print_pos_ber=False, print_pos_power=False, print_test_traj=False, radar_power=5.0, radar_prob=0.05, rec_quantize=False, rec_quantize_level=2, rec_quantize_limit=1.0, snr_points=12, snr_test_end=4.0, snr_test_start=-1.5, test_channel_mode='block_norm', test_ratio=1, train_channel_mode='block_norm', train_dec_channel_high=2.0, train_dec_channel_low=-1.5, train_enc_channel_high=1.0, train_enc_channel_low=1.0, vv=5)
Channel_AE(
  (enc): ENC(
    (enc_rnn): GRU(1, 100, num_layers=2, batch_first=True)
    (enc_linear): Linear(in_features=100, out_features=3, bias=True)
  )
  (dec): DEC(
    (dropout): Dropout(p=0.0, inplace=False)
    (dec1_rnns): GRU(3, 100, num_layers=2, batch_first=True)
    (dec2_rnns): GRU(3, 100, num_layers=2, batch_first=True)
    (dec_outputs): Linear(in_features=200, out_features=1, bias=True)
  )
)
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
====> Epoch: 1 Average loss: 0.69135417  running time 1.1188106536865234
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
====> Epoch: 1 Average loss: 0.66577849  running time 0.872342586517334
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
====> Epoch: 1 Average loss: 0.59616587  running time 0.8776729106903076
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
====> Epoch: 1 Average loss: 0.47126196  running time 0.9091076850891113
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
====> Epoch: 1 Average loss: 0.42426821  running time 0.9361248016357422
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
====> Epoch: 1 Average loss: 0.42026872  running time 0.958012580871582
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
====> Test set BCE loss 0.38104555010795593 Custom Loss 0.38104555010795593 with ber  0.17120999097824097
saved model ./tmp/torch_model_321389.pt
SNRS [-1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0]
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
no pos BER specified.
Test SNR -1.5 with ber  0.3093400001525879 with bler 1.0
Punctured Test SNR -1.5 with ber  0.0 with bler 0.0
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
no pos BER specified.
Test SNR -1.0 with ber  0.303849995136261 with bler 1.0
Punctured Test SNR -1.0 with ber  0.0 with bler 0.0
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
no pos BER specified.
Test SNR -0.5 with ber  0.293040007352829 with bler 1.0
Punctured Test SNR -0.5 with ber  0.0 with bler 0.0
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
no pos BER specified.
Test SNR 0.0 with ber  0.28429001569747925 with bler 1.0
Punctured Test SNR 0.0 with ber  0.0 with bler 0.0
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
no pos BER specified.
Test SNR 0.5 with ber  0.2726700007915497 with bler 1.0
Punctured Test SNR 0.5 with ber  0.0 with bler 0.0
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
no pos BER specified.
Test SNR 1.0 with ber  0.26170000433921814 with bler 1.0
Punctured Test SNR 1.0 with ber  0.0 with bler 0.0
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
no pos BER specified.
Test SNR 1.5 with ber  0.2488499879837036 with bler 1.0
Punctured Test SNR 1.5 with ber  0.0 with bler 0.0
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
no pos BER specified.
Test SNR 2.0 with ber  0.2400199919939041 with bler 1.0
Punctured Test SNR 2.0 with ber  0.0 with bler 0.0
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
no pos BER specified.
Test SNR 2.5 with ber  0.22958998382091522 with bler 1.0
Punctured Test SNR 2.5 with ber  0.0 with bler 0.0
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
no pos BER specified.
Test SNR 3.0 with ber  0.218189999461174 with bler 1.0
Punctured Test SNR 3.0 with ber  0.0 with bler 0.0
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
no pos BER specified.
Test SNR 3.5 with ber  0.2063099890947342 with bler 1.0
Punctured Test SNR 3.5 with ber  0.0 with bler 0.0
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
default AWGN channel
no pos BER specified.
Test SNR 4.0 with ber  0.19455000758171082 with bler 1.0
Punctured Test SNR 4.0 with ber  0.0 with bler 0.0
final results on SNRs  [-1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0]
BER [0.3093400001525879, 0.303849995136261, 0.293040007352829, 0.28429001569747925, 0.2726700007915497, 0.26170000433921814, 0.2488499879837036, 0.2400199919939041, 0.22958998382091522, 0.218189999461174, 0.2063099890947342, 0.19455000758171082]
BLER [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
final results on punctured SNRs  [-1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0]
BER [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
BLER [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
encoder power is tensor(1., device='cuda:0')
adjusted SNR should be [-1.4999997446509226, -1.0000000166986343, -0.49999973308696327, -0.0, 0.5000001308463472, 1.0000002900227403, 1.5000000201403676, 2.0000002404171053, 2.5000000877622415, 3.0000002493010487, 3.500000207085638, 3.999999717024358]
